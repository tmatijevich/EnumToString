<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IEC 61131-3 Enumeration to String</title>
  <script>
    document.addEventListener("DOMContentLoaded", (event) => {
      document.getElementById("generate-button").addEventListener("mousedown", (event) => {
        var definitionExpression = /(\w+)\s+\:\s+\(\s+(?:\(\*[\w\,\.\s]+\*\)\s*)?([\w\s\,\:\=(?:\(\*)(?:\*\))]+)\)\s*\;/m;
        var definitionMatch = document.getElementById("enumeration-definition").value.match(definitionExpression);
        if (definitionMatch == null) {
          console.log("No enumeration definition match found");
          return;
        }
        console.log("Definition matched at", definitionMatch.index);
        for (let i = 0; i < definitionMatch.length ; i++) {
          console.log(definitionMatch[i]);
        }
        var index = 0;
        var enumerationExpression = /(\w+)\s*(?:\:\=\s*\w+\s*)?\,?\s*(?:\(\*.*\*\))?/m;
        while (true) {
          let enumerationMatch = definitionMatch[2].slice(index).match(enumerationExpression);
          if (enumerationMatch == null)
            break;
          console.log("Enumeration match", enumerationMatch[1], "at", enumerationMatch.index, "of length", enumerationMatch[0].length);
          index += enumerationMatch.index + enumerationMatch[0].length;
        }
        document.getElementById("paragraph-result").textContent = document.getElementById("enumeration-definition").value;
      })
    })
  </script>
</head>
<body>
  <p><label for="enumeration-definition">Enumeration Definition</label></p>
  <p><textarea name="enumeration-definition-input" id="enumeration-definition" cols="50" rows="10"></textarea></p>
  <p><button id="generate-button" type="button">Generate</button></p>
  <p id="paragraph-result">Test</p>
</body>
</html>